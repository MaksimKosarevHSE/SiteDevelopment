<?php

require_once __DIR__ . "/../../../vendor/autoload.php";

use Shuchkin\SimpleXLSX;


function getPlan()
{
    $arr = [];
    $a = [];
    if ($xlsx = SimpleXLSX::parse(__DIR__ . '/q.xlsx')) {
        $table = $xlsx->rows();

        //кнт1
        {
            $a = 4;
            $group = 1;
            for ($i = 11; $i < 17; $i++) {

                $ceil = $table[$i][$a];
                $arr["mon"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["mon"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 22; $i < 30; $i++) {
                $ceil = $table[$i][$a];
                $arr["tue"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["tue"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 33; $i < 41; $i++) {
                $ceil = $table[$i][$a];
                $arr["wen"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["wen"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            $ceil = $table[44][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;

            $ceil = $table[50][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[50][$a + 1];

            $ceil = $table[51][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[51][$a + 1];

            for ($i = 55; $i < 62; $i++) {
                $ceil = $table[$i][$a];
                $arr["fri"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["fri"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 66; $i < 73; $i++) {
                $ceil = $table[$i][$a];
                $arr["sut"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["sut"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }


        }



        //кнт2
        {
            $a = 7;
            $group = 2;
            for ($i = 11; $i < 17; $i++) {

                $ceil = $table[$i][$a];
                $arr["mon"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["mon"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 22; $i < 30; $i++) {
                $ceil = $table[$i][$a];
                $arr["tue"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["tue"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 33; $i < 41; $i++) {
                $ceil = $table[$i][$a];
                $arr["wen"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["wen"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }


            $ceil = $table[44][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;

            $ceil = $table[50][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[50][$a + 1];

            $ceil = $table[51][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[51][$a + 1];


            for ($i = 55; $i < 62; $i++) {
                $ceil = $table[$i][$a];
                $arr["fri"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["fri"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 66; $i < 73; $i++) {
                $ceil = $table[$i][$a];
                $arr["sut"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["sut"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }


        }


        //кнт3
        {
            $a = 10;
            $group = 3;
            for ($i = 11; $i < 17; $i++) {

                $ceil = $table[$i][$a];
                $arr["mon"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["mon"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 22; $i < 30; $i++) {
                $ceil = $table[$i][$a];
                $arr["tue"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["tue"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 33; $i < 41; $i++) {
                $ceil = $table[$i][$a];
                $arr["wen"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["wen"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            $ceil = $table[44][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;

            $ceil = $table[50][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[50][$a + 1];

            $ceil = $table[51][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[51][$a + 1];

            for ($i = 55; $i < 62; $i++) {
                $ceil = $table[$i][$a];
                $arr["fri"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["fri"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 66; $i < 73; $i++) {
                $ceil = $table[$i][$a];
                $arr["sut"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["sut"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }


        }


        //кнт4
        {
            $a = 16;
            $group = 4;
            for ($i = 11; $i < 17; $i++) {

                $ceil = $table[$i][$a];
                $arr["mon"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["mon"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 22; $i < 30; $i++) {
                $ceil = $table[$i][$a];
                $arr["tue"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["tue"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 33; $i < 41; $i++) {
                $ceil = $table[$i][$a];
                $arr["wen"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["wen"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            $ceil = $table[44][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;

            $ceil = $table[50][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[50][$a + 1];

            $ceil = $table[51][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[51][$a + 1];

            for ($i = 55; $i < 62; $i++) {
                $ceil = $table[$i][$a];
                $arr["fri"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["fri"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 66; $i < 73; $i++) {
                $ceil = $table[$i][$a];
                $arr["sut"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["sut"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }


        }


        //кнт5
        {
            $a = 19;
            $group = 5;
            for ($i = 11; $i < 17; $i++) {

                $ceil = $table[$i][$a];
                $arr["mon"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["mon"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 22; $i < 30; $i++) {
                $ceil = $table[$i][$a];
                $arr["tue"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["tue"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 33; $i < 41; $i++) {
                $ceil = $table[$i][$a];
                $arr["wen"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["wen"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            $ceil = $table[44][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;

            $ceil = $table[50][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[50][$a + 1];

            $ceil = $table[51][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[51][$a + 1];

            for ($i = 55; $i < 62; $i++) {
                $ceil = $table[$i][$a];
                $arr["fri"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["fri"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 66; $i < 73; $i++) {
                $ceil = $table[$i][$a];
                $arr["sut"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["sut"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }


        }

        //кнт6
        {
            $a = 22;
            $group = 6;
            for ($i = 11; $i < 17; $i++) {

                $ceil = $table[$i][$a];
                $arr["mon"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["mon"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 22; $i < 30; $i++) {
                $ceil = $table[$i][$a];
                $arr["tue"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["tue"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 33; $i < 41; $i++) {
                $ceil = $table[$i][$a];
                $arr["wen"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["wen"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            $ceil = $table[44][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;

            $ceil = $table[50][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[50][$a + 1];

            $ceil = $table[51][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[51][$a + 1];

            for ($i = 55; $i < 62; $i++) {
                $ceil = $table[$i][$a];
                $arr["fri"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["fri"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 66; $i < 73; $i++) {
                $ceil = $table[$i][$a];
                $arr["sut"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["sut"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }


        }

        //кнт7
        {
            $a = 28;
            $group = 7;
            for ($i = 11; $i < 17; $i++) {

                $ceil = $table[$i][$a];
                $arr["mon"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["mon"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 22; $i < 30; $i++) {
                $ceil = $table[$i][$a];
                $arr["tue"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["tue"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 33; $i < 41; $i++) {
                $ceil = $table[$i][$a];
                $arr["wen"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["wen"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            $ceil = $table[44][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;

            $ceil = $table[50][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[50][$a + 1];

            $ceil = $table[51][$a];
            $arr["thur"]["knt{$group}"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[51][$a + 1];

            for ($i = 55; $i < 62; $i++) {
                $ceil = $table[$i][$a];
                $arr["fri"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["fri"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 66; $i < 73; $i++) {
                $ceil = $table[$i][$a];
                $arr["sut"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["sut"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }


        }

        //кнт8
        {
            $a = 31;
            $group = 8;
            for ($i = 11; $i < 17; $i++) {

                $ceil = $table[$i][$a];
                $arr["mon"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["mon"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 22; $i < 30; $i++) {
                $ceil = $table[$i][$a];
                $arr["tue"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["tue"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 33; $i < 41; $i++) {
                $ceil = $table[$i][$a];
                $arr["wen"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["wen"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            $ceil = $table[44][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;

            $ceil = $table[50][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[50][$a + 1];

            $ceil = $table[51][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[51][$a + 1];

            for ($i = 55; $i < 62; $i++) {
                $ceil = $table[$i][$a];
                $arr["fri"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["fri"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 66; $i < 73; $i++) {
                $ceil = $table[$i][$a];
                $arr["sut"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["sut"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }


        }


        //кнт9
        {
            $a = 34;
            $group = 9;
            for ($i = 11; $i < 17; $i++) {

                $ceil = $table[$i][$a];
                $arr["mon"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["mon"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 22; $i < 30; $i++) {
                $ceil = $table[$i][$a];
                $arr["tue"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["tue"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 33; $i < 41; $i++) {
                $ceil = $table[$i][$a];
                $arr["wen"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["wen"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            $ceil = $table[44][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;

            $ceil = $table[50][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[50][$a + 1];

            $ceil = $table[51][$a];
            $arr["thur"]["knt{$group}"]["lessons"][] = $ceil;
            $arr["thur"]["knt{$group}"]["audit"][] = $table[51][$a + 1];

            for ($i = 55; $i < 62; $i++) {
                $ceil = $table[$i][$a];
                $arr["fri"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["fri"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }

            for ($i = 66; $i < 73; $i++) {
                $ceil = $table[$i][$a];
                $arr["sut"]["knt{$group}"]["lessons"][] = $ceil;
                $arr["sut"]["knt{$group}"]["audit"][] = $table[$i][$a + 1];
            }


        }
        $a = $arr;
    } else {


    }

    return json_encode($a);
}
